<html lang="en-US">

<head>
    <meta charset="utf-8">
    <title> Viewer </title>
    <script src="https://cdn.firebase.com/js/client/2.2.1/firebase.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.0/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.1.0/js/md5.js"></script>
    <script src="/js/blog.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />

    <style>
        @import url(http://fonts.googleapis.com/css?family=Montserrat);
        @import url(https://fonts.googleapis.com/css?family=Lato);
        @import url(https://fonts.googleapis.com/css?family=PT+Sans);
        @import url(https://fonts.googleapis.com/css?family=Noto+Sans+SC);
        @import url(https://fonts.googleapis.com/css?family=Fira+Sans);

        body {
            background-color: #222121;
        }

        .loginbutton {
            font-size: 16px;
            font-family: 'PT Sans', sans-serif;
            color: #ffffff;
            margin-top: 8px;
            margin-left: 20px;
            margin-bottom: -70px;
            height: 4.9vh;
            background-color: #FF8C00;
            border: 0;
            border-radius: 5px;
            padding: 0 16.5 0 16.5;
        }

        .logo {
            display: inline-block;
            width: 50%;
        }

        .commentsection {
            color: white;
            font-family: 'Fira Sans', sans-serif;
            margin-top: 40px;
            width: 1380px;
            margin-bottom: 60px;
        }

        header {
            font-size: 30px;
            margin-bottom: 15px;
            text-align: left;
        }

        embed {
            border: 3px solid grey;
        }

        p {
            text-align: center;
            font-size: 20px;
            margin-bottom: 0px;
        }

        a {
            color: yellow;
        }

        .comment {
            font-family: 'Fira Sans', sans-serif;
            color: white;
            border: 1px solid white;
            padding: 3 15 10 10;
            width: 700px;
            align-content: left;
            margin-bottom: 20px;
        }

        #message {
            width: 500px;
            height: 50px;
            margin-left: 4u00px;
        }

        .parent {
            text-align: center;
        }

        .comments {
            display: inline-block;
        }

        img[type=avatar] {
            margin-left: -590px;
            height: 55px;
            width: auto;
            border-radius: 50%;
            margin-top: -40px;
            margin-right: 35px;
        }

        img[type=flag] {
            height: 25px;
            width: auto;
            margin-right: -660px;
            margin-top: -60px;
        }

        label {
            font-size: 20px;
        }

        #actualcomment {
            text-align: left;
            margin-top: 50px;
            margin-left: 7px;
            font-size: 20px;
            word-wrap: break-word;
            width: 600px;
        }

        #time {
            /* margin-top: -35px;
            margin-left: -435px; */
            font-size: 15px;
            text-align: right;
            margin-top: -60px;
        }

        #user {
            margin-top: 25px;
            font-size: 18px;
        }

        /* The Modal (background) */
        .modal {
            display: hidden;
            /* Hidden by default */
            position: fixed;
            /* Stay in place */
            z-index: 1;
            /* Sit on top */
            padding-top: 100px;
            /* Location of the box */
            left: 0;
            top: 0;
            width: 100%;
            /* Full width */
            height: 100%;
            /* Full height */
            overflow: auto;
            /* Enable scroll if needed */
            background-color: rgb(0, 0, 0);
            /* Fallback color */
            background-color: rgba(0, 0, 0, 0.4);
            /* Black w/ opacity */
        }

        /* Modal Content */
        .modal-content {
            position: relative;
            background-color: #fefefe;
            margin: auto;
            padding: 0;
            border: 1px solid #888;
            width: 800px;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
            -webkit-animation-name: animatetop;
            -webkit-animation-duration: 0.4s;
            animation-name: animatetop;
            animation-duration: 0.4s;
            font-family: 'Fira Sans', sans-serif;
            text-align: left;
        }

        /* Add Animation */
        @-webkit-keyframes animatetop {
            from {
                top: -300px;
                opacity: 0
            }

            to {
                top: 0;
                opacity: 1
            }
        }

        @keyframes animatetop {
            from {
                top: -300px;
                opacity: 0
            }

            to {
                top: 0;
                opacity: 1
            }
        }

        /* The Close Button */
        .close {
            color: black;
            font-size: 28px;
            font-weight: bold;
            float: right;
        }

        .close:hover,
        .close:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }

        .modal-header {
            padding: 2px 16px;
            background-color: white;
            color: black;
            font-size: 45px;

        }

        .modal-body {
            padding: 2px 16px;
            margin-top: 10px;
            color: black;
            font-size: 17px;
            align-content: left;
        }

        input[type=submit] {
            color: black;
        }

        #myBtn {
            border: none;
            background: transparent;
        }

        #report {
            width: 690px;
            margin-top: 5px;
            margin-bottom: 10px;
            height: 40px;
        }

        .navigation {
            color: white;
            font-family: 'Fira Sans', sans-serif;
            font-size: 19.5px;
            margin-left: 39px;
            height: 40px;
            display: block;
            margin-top: 8px;
        }

        .navback {
            background-color: rgb(41, 40, 40);
            margin-top: 8px;
        }


        .container {
            display: flex;
            width: 13%;
            margin-left: 1205px;
            overflow: hidden;
            margin-top: -25px;
        }

        .button-container {
            padding: 0px 4px;
            margin-top: -5px;
        }

        .button-container:not(:last-child) {
            margin-top: -2px;
            margin-right: 7px;
            height: 20px;
            border-right: 0.5px solid white;
        }

        input[type=image] {
            margin-left: 1500px;
            height: 25px;
            width: 25px;
        }

        button {
            background: none;
            border: none;
            display: inline-block;
            outline: none;
        }

        button:hover {
            background-color: grey;
        }

        button:focus {
            background-color: grey;
        }

        #LectureNotes a,
        #Tutorials a,
        #PYP a,
        #ExtraPractice a,
        #Misc a {
            color: black;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            text-align: left;
            background-color: white;
            width: 90%;
            margin-top: 7px;
        }
    </style>

</head>

<body>
    <div>
        <a href=/Users/keiftan/Downloads/StuDIY-master/index.html> <img type="logo"
            src=data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBB%0D%0AZG9iZSBJbGx1c3RyYXRvciAxNS4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9u%0D%0AOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBT%0D%0AVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzEx%0D%0ALmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3%0D%0ALnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxp%0D%0AbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iMTAyLjI1cHgiIGhlaWdodD0iMjIuNXB4IiB2%0D%0AaWV3Qm94PSIyMi4zNjUgNTQuODY1IDEwMi4yNSAyMi41IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3%0D%0AIDIyLjM2NSA1NC44NjUgMTAyLjI1IDIyLjUiDQoJIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPHBh%0D%0AdGggZmlsbD0iI0VDRTcwRCIgZD0iTTI0LjQ2Niw3Mi4yNTRsMi41OTQtMy4wOTdjMS42OCwxLjMy%0D%0ALDMuNTA0LDIuMDE3LDUuNDQ3LDIuMDE3YzEuMjcyLDAsMS45NDQtMC40MzMsMS45NDQtMS4xNXYt%0D%0AMC4wNDgNCgljMC0wLjcyMi0wLjU1Mi0xLjA4LTIuODU0LTEuNjM0Yy0zLjU3Ni0wLjgxNC02LjMz%0D%0AOC0xLjgyMi02LjMzOC01LjI1N3YtMC4wNDhjMC0zLjEyLDIuNDc0LTUuMzc3LDYuNTA2LTUuMzc3%0D%0ADQoJYzIuODU0LDAsNS4wODgsMC43NzEsNi45MTEsMi4yMzJsLTIuMzI2LDMuMjg4Yy0xLjUzNi0x%0D%0ALjEwNC0zLjIxOC0xLjY1Ni00LjcwNS0xLjY1NmMtMS4xMjgsMC0xLjY4MiwwLjQ1Ni0xLjY4Miwx%0D%0ALjA4djAuMDQ5DQoJYzAsMC43NjgsMC41NzYsMS4xMDQsMi45MywxLjYzMmMzLjg0LDAuODQsNi4y%0D%0AMzksMi4wODgsNi4yMzksNS4yMzJ2MC4wNDhjMCwzLjQzMy0yLjcxMiw1LjQ3My02Ljc5Miw1LjQ3%0D%0AMw0KCUMyOS4zNjIsNzUuMDM4LDI2LjU1NCw3NC4xMDEsMjQuNDY2LDcyLjI1NHoiLz4NCjxwYXRo%0D%0AIGZpbGw9IiNFQ0U3MEQiIGQ9Ik00NS4wMSw2Mi4wMjloLTUuMDE2di00LjA4MWgxNC43MTN2NC4w%0D%0AODFoLTUuMDQxVjc0Ljc1SDQ1LjAxVjYyLjAyOXoiLz4NCjxwYXRoIGZpbGw9IiNFQ0U3MEQiIGQ9%0D%0AIk01Ni41NTMsNjcuMzgydi05LjQzNGg0LjcwM3Y5LjMzN2MwLDIuNDI1LDEuMjI2LDMuNTc2LDMu%0D%0AMDk4LDMuNTc2YzEuODk2LDAsMy4xMjEtMS4xMDQsMy4xMjEtMy40NTZ2LTkuNDU3DQoJaDQuNzA1%0D%0AdjkuMzEyYzAsNS40LTMuMDk5LDcuODAzLTcuODczLDcuODAzQzU5LjU1NCw3NS4wNjIsNTYuNTUz%0D%0ALDcyLjYzNyw1Ni41NTMsNjcuMzgyeiIvPg0KPHBhdGggZmlsbD0iI0VDRTcwRCIgZD0iTTc0Ljkz%0D%0ANyw1Ny45NDhoNi41MDVjNS45NzcsMCw5LjQ1NywzLjQ1Nyw5LjQ1Nyw4LjMwNXYwLjA0OGMwLDQu%0D%0AODUxLTMuNTI4LDguNDQ5LTkuNTU0LDguNDQ5aC02LjQwOFY1Ny45NDgNCgl6IE03OS41OTQsNjIu%0D%0AMDUydjguNTY5aDEuODk2YzIuODA5LDAsNC42NTYtMS41MzYsNC42NTYtNC4yNDl2LTAuMDQ4YzAt%0D%0AMi42ODgtMS44NS00LjI3Mi00LjY1Ni00LjI3Mkg3OS41OTR6Ii8+DQo8cGF0aCBmaWxsPSIjRUNF%0D%0ANzBEIiBkPSJNOTMuNDQxLDU3Ljk0OGg0LjY1NlY3NC43NWgtNC42NTZWNTcuOTQ4eiIvPg0KPHBh%0D%0AdGggZmlsbD0iI0VDRTcwRCIgZD0iTTEwNi4wNDIsNjguNDYybC02LjQwOC0xMC41MTRoNS4zMDds%0D%0AMy40NTYsNi4xMjFsMy40NzktNi4xMjFoNS4yMDhsLTYuMzg1LDEwLjQ0MXY2LjM1OGgtNC42NTZW%0D%0ANjguNDYyDQoJTDEwNi4wNDIsNjguNDYyeiIvPg0KPGNpcmNsZSBmaWxsPSIjRUNFNzBEIiBjeD0i%0D%0AMTE4LjAyNSIgY3k9IjcxLjgwNiIgcj0iMi45NDIiLz4NCjwvc3ZnPg0K
            alt="art" style="margin-top: 12px; margin-left: 30px;" height=55px></a>
        <br>
        <div class="navback">
            <div class="navigation">
                <button class="dropBtn"
                    style="display: inline-block; margin-right: 25px; margin-top: 6px; color: white;" onclick="openTab(event, 'LectureNotes')"
                    > Lecture Notes </button>
                <div id="LectureNotes" class="dropdown-content" >
                </div>
                <button class="dropBtn" style="display: inline-block; margin-right: 40px; color: white; " onclick="openTab(event, 'Tutorials')"
                    >
                    Tutorials
                </button>
                <div id="Tutorials" class="dropdown-content">
                </div>
                <button style="display: inline; margin-right: 40px; color: white;" onclick="openTab(event, 'PYP')" 
                    class="dropBtn"> Past Year
                    Papers </button>
                <div id="PYP" class="dropdown-content" >
                </div>
                <button style="display: inline; margin-right: 40px; color: white;" onclick="openTab(event, 'ExtraPractice')"  
                    class="dropBtn"> Extra
                    Practice
                </button>
                <div id="ExtraPractice" class="dropdown-content">
                </div>
                <button style="display: inline; margin-right: 40px; color: white;" onclick="openTab(event, 'Misc')"
                    class="dropBtn">
                    Miscellaneous
                </button>
                <div id="Misc" class="dropdown-content">
                </div>
                <a style="display: inline; margin-right: 200px; color: white;"> Forum </a>
                <div class="container">
                    <div class="button-container"><a
                            style="display: inline-block; margin-left: 20px; margin-right: 5px; color: white; margin-top: -1px;"
                            href=../index.html> <img src="http://codeitdown.com/media/Home_Icon.svg"
                            style="height: 25px; width: auto;" type="logo" /></a></div>
                    <div class="button-container"><a style="display: inline-block; color: white; margin-top: 1.5px;">
                            Sign Out </a></div>
                </div>
            </div>
        </div>
    </div>

    <embed src="" width="560px" height="650px" style="margin-left: 450px; margin-top: 45px;" id="viewer" />

    <div class="parent">
        <div class="commentsection">
            <header style="margin-top: 0px; margin-left: 450px; "> Leave a comment </header>
            <form id="comment">
                <label for="message" style="margin-bottom: 30px; margin-left: -400px;">Message</label>
                <br>
                <textarea id="message" style="color: black; height: 100px; margin-left: 290px; width: 560px;"
                    placeholder="Enter a comment"></textarea>

                <label for="name">Name</label>
                <input type="text" id="name" style="color: black; margin-bottom: 30px;" autocomplete="off">
                <br>
                <input type="submit" value="Post Comment" style="margin-left: 520px;">
            </form>
        </div>
    </div>

    <hr style="width: 500px; margin-bottom: 60px;">

    <div class="parent">
        <div class="comments"> </div>
    </div>

    <!-- The Modal -->
    <div id="myModal" class="modal">

        <!-- Modal content -->
        <div class="modal-content">
            <div class="modal-header">
                <span class="close">&times;</span>
                <h2>Report comment</h2>
            </div>
            <div class="modal-body">
                <p style="font-size: 17px; text-align: left;">Choose a reason for reporting this comment</p>
                <select style="margin-left: 0px; margin-top: 5px;" id="reporting">
                    <option value=""> Abuse </option>
                    <option value=""> Spam </option>
                    <option value=""> Off Topic </option>
                </select>
                <hr>
                <p style="font-size: 17px; text-align: left;"> What would you like to report? </p>
                <input type="text" name="report" id="report"
                    placeholder="Please provide details about the comment or account you are reporting."
                    style="font-size: 15px; text-align: initial;" autocomplete="off">
                <input type="submit" value="Submit">
            </div>
        </div>
    </div>
</body>

</html>
<script src="https://www.gstatic.com/firebasejs/6.2.3/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.2.3/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.2.3/firebase-storage.js"></script>

<script>
    // Initialize Firebase
    const firebaseConfig = {
    apiKey: "AIzaSyBoWu-FQKyuskKlXF77SknhQazBi6tQpEI",
    authDomain: "studiy.firebaseapp.com",
    databaseURL: "https://studiy.firebaseio.com",
    projectId: "studiy",
    storageBucket: "studiy.appspot.com",
    messagingSenderId: "973457443239",
    appId: "1:973457443239:web:e6be93a824079bb0"
    };
    firebase.initializeApp(firebaseConfig);

    let lectureNotesStatus = false;
    let tutorialStatus = false;
    let pypStatus = false;
    let extraPracticeStatus = false;
    let miscStatus = false;
    let moduleCode;
    
    //decoding the URI components and loading the relevant files in the same mods in the tabs
    window.onload = function () {
        let url = document.location.href;
        let params = url.split('?')[1].split('&');
        let viewURL = decodeURIComponent(params[0]);
        viewURL = viewURL.substr(4);
        console.log(viewURL);

        moduleCode = viewURL.substring(viewURL.lastIndexOf("/") + 1).split("%")[0];
        console.log(moduleCode);
        //replacing the empty <embed>
        let oldViewer = document.getElementById('viewer');
        let newViewer = oldViewer.cloneNode(true);
        newViewer.setAttribute('src', viewURL);
        oldViewer.parentNode.replaceChild(newViewer, oldViewer);

        if (!lectureNotesStatus) {
                lectureNotesStatus = true;
                // Create a reference under which you want to list
                var listRef = firebase.storage().ref().child(moduleCode + '/' + 'lectureNotes');
                
                // Find all the prefixes and items.
                listRef.listAll().then(
                function(res) {
                res.items.forEach(function(itemRef) {
                    // All the items under listRef.
                    console.log(itemRef.fullPath);
                    
                    itemRef.getDownloadURL().then(function(url) {
                        //using the GET method to concatenate the link url of the pdf that will be opened in pdfViewer
                        viewerUrl = 'pdfViewer.html?name' + encodeURIComponent(url);
                        // Populating the categories with links
                        let br = document.createElement('br');
                        let a = document.createElement('a');
                        let linkText = document.createTextNode(itemRef.fullPath);
                        a.appendChild(linkText);
                        a.href = viewerUrl;
                        let lectureNotes = document.getElementById('LectureNotes');
                        lectureNotes.appendChild(a);
                        lectureNotes.appendChild(br);
                    });

                });
                }).catch(function(error) {
                    console.log('error(Lecture Notes)');
                });
                // document.getElementById("LectureNotes").classList.toggle("show");
            }

        if (!tutorialStatus) {
            tutorialStatus = true;
            // Create a reference under which you want to list
            var listRef = firebase.storage().ref().child(moduleCode + '/' + 'tutorials');
            
            // Find all the prefixes and items.
            listRef.listAll().then(
            function(res) {
            res.items.forEach(function(itemRef) {
                // All the items under listRef.
                // Populating the categories with links

                itemRef.getDownloadURL().then(function(url) {
                    //using the GET method to concatenate the link url of the pdf that will be opened in pdfViewer
                    viewerUrl = 'pdfViewer.html?name' + encodeURIComponent(url);
                    // Populating the categories with links
                    let br = document.createElement('br');
                    let a = document.createElement('a');
                    let linkText = document.createTextNode(itemRef.fullPath);
                    a.appendChild(linkText);
                    a.href = viewerUrl;
                    let tutorialsElement = document.getElementById('Tutorials');
                    tutorialsElement.appendChild(a);
                    tutorialsElement.appendChild(br);
                });
            });
            }).catch(function(error) {
                console.log('error(Tutorials)');
            });
            // document.getElementById("Tutorials").classList.toggle("show");
        }

        if (!pypStatus) {
            pypStatus = true;
            // Create a reference under which you want to list
            var listRef = firebase.storage().ref().child(moduleCode + '/' + 'pastYearPapers');
            
            // Find all the prefixes and items.
            listRef.listAll().then(
            function(res) {
            res.items.forEach(function(itemRef) {
                // All the items under listRef.
                console.log(itemRef.fullPath);
                itemRef.getDownloadURL().then(function(url) {
                    //using the GET method to concatenate the link url of the pdf that will be opened in pdfViewer
                    viewerUrl = 'pdfViewer.html?name' + encodeURIComponent(url);
                    // Populating the categories with links
                    let br = document.createElement('br');
                    let a = document.createElement('a');
                    let linkText = document.createTextNode(itemRef.fullPath);
                    a.appendChild(linkText);
                    a.href = viewerUrl;
                    let pypElement = document.getElementById("PYP");
                    pypElement.appendChild(a);
                    pypElement.appendChild(br);
                });
            });
            }).catch(function(error) {
                console.log('error(PYPs)');
            });
            // document.getElementById("PYP").classList.toggle("show");
        }

        if (!extraPracticeStatus) {
            extraPracticeStatus = true;
            // Create a reference under which you want to list
            var listRef = firebase.storage().ref().child(moduleCode + '/' + 'extraPractice');
            
            // Find all the prefixes and items.
            listRef.listAll().then(
            function(res) {
            res.items.forEach(function(itemRef) {
                // All the items under listRef.
                itemRef.getDownloadURL().then(function(url) {
                    //using the GET method to concatenate the link url of the pdf that will be opened in pdfViewer
                    viewerUrl = 'pdfViewer.html?name' + encodeURIComponent(url);
                    // Populating the categories with links
                    let br = document.createElement('br');
                    let a = document.createElement('a');
                    let linkText = document.createTextNode(itemRef.fullPath);
                    a.appendChild(linkText);
                    a.href = viewerUrl;
                    extraPracticeElement = document.getElementById('ExtraPractice');
                    extraPracticeElement.appendChild(a);
                    extraPracticeElement.appendChild(br);
                });
            });
            }).catch(function(error) {
                console.log('error(Extra Practices)');
            }); 
            // document.getElementById("ExtraPractice").classList.toggle("show");
        }

        if (!miscStatus) {
            miscStatus = true;
            // Create a reference under which you want to list
            var listRef = firebase.storage().ref().child(moduleCode + '/' + 'miscellaneous');
            /*
            var itemArray = []; 
            itemArray.sort(function (a, b) {
                a.year - b.year;
            });
            itemArray.sort(function (a, b) {

            }); */
            // Find all the prefixes and items.
            listRef.listAll().then(
            function(res) {
            res.items.forEach(function(itemRef) {
                // Populating the categories with links
                itemRef.getDownloadURL().then(function(url) {
                    //using the GET method to concatenate the link url of the pdf that will be opened in pdfViewer
                    viewerUrl = 'pdfViewer.html?name' + encodeURIComponent(url);
                    // Populating the categories with links
                    let br = document.createElement('br');
                    let a = document.createElement('a');
                    let linkText = document.createTextNode(itemRef.fullPath);
                    a.appendChild(linkText);
                    a.href = viewerUrl;
                    let miscElement = document.getElementById("Misc");
                    miscElement.appendChild(a);
                    miscElement.appendChild(br);
                });
            });
            }).catch(function(error) {
                console.log('error(Miscellaneous)');
            }); 
            //document.getElementById("Misc").classList.toggle("show");
        }
    }

    let currentTab;

    function openTab(evt, tabId) {
        // Declare all variables 
        var i, dropdownContent, dropdownLinks;

        //Get all elements with class="dropdown-content" and hide them
        dropdownContent = document.getElementsByClassName("dropdown-content");
        for (i = 0; i < dropdownContent.length ; i++) {
            dropdownContent[i].style.display = "none";
        }

        // Get all elements with class "dropdownLinks"
        dropdownLinks = document.getElementsByClassName("dropBtn");
        for (i = 0; i < dropdownLinks.length; i++) {
            dropdownLinks[i].className = dropdownLinks[i].className.replace(" active", "");
        }

        //Show the current tab, and add an "active" class to the button that opened the tab
        if (!(evt.currentTarget === currentTab)) {
            document.getElementById(tabId).style.display = "block";
            evt.currentTarget.className += " active";
            currentTab = evt.currentTarget;
        } else {
            document.getElementById(tabId).style.display = "none"; 
            evt.currentTarget.className.replace(" active", "");
            currentTab = null;
        }
    }
    
    
        

    //this is for when any part of the document is clicked if any tab is still open it will close 
    $(document).on('click', function (event) {
        //if we press clock anywhere but the tabs
        if (!event.target.closest('.dropbtn')) {
            var dropdowns = document.getElementsByClassName("dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.style.display === "block") {
                    openDropdown.style.display = "none";
                }

            }
        }
    });
    
    //To retrieve comments from firebase
    $(function () {
        var commentsRef = database.ref("-users-keiftan-downloads-studiy-master-pdfviewer-pdfviewer-html");
        commentsRef.on("value", function (snapshot) {
            snapshot.forEach(function (childSnapshot) {
                var childData = childSnapshot.val();
                if (childData.address == document.location.href) {
                    $(".comments").prepend(
                        '<div class="comment">' +
                        '<p id = "user" style = "text-align: left; margin-left: 60px;">' + escapeHtml(childData.name) + '</p>' +
                        '<div class="profile-image"><img type = "avatar" src="http://www.gravatar.com/avatar/' + '?s=100&d=retro"/></div> ' +
                        '<p id = "time">' + moment(childData.postedAt).fromNow() + '</p><p id = "actualcomment">' + escapeHtml(childData.message) + '</p>' +
                        '<input type = "image" src="https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/240/emojione/211/triangular-flag-on-post_1f6a9.png" style = "margin-left: 650px;" /></div>');

                };
            });
        });

        var ref = new Firebase("https://studiy.firebaseio.com/");
        postRef = ref.child(slugify(window.location.pathname));

        $("#comment").submit(function () {
            var a = postRef.push();
            a.set({
                name: $("#name").val(),
                message: $("#message").val(),
                postedAt: Firebase.ServerValue.TIMESTAMP,
                address: document.location.href,
            });
            $("input[type=text], textarea").val("");
            return false;
        });
    });
    function slugify(text) {
        return text.toString().toLowerCase().trim()
            .replace(/&/g, '-and-')
            .replace(/[\s\W-]+/g, '-')
            .replace(/[^a-zA-Z0-9-_]+/g, '');
    }
    function escapeHtml(str) {
        var div = document.createElement('div');
        div.appendChild(document.createTextNode(str));
        return div.innerHTML;
    }
    // Get the modal
    var modal = document.getElementById("myModal");
    // Get the button that opens the modal
    /* var btn = document.getElementById("myBtn"); */
    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];
    // When the user clicks the button, open the modal
    $('.comments').on('click', 'input[type=image]', function () {
        modal.style.display = "block";
    });
    // When the user clicks on <span> (x), close the modal
    span.onclick = function () {
        modal.style.display = "none";
    }
    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function (event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }

    
</script>
